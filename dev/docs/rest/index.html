---
layout: page
pretitle: Development Centre
title: "Kraken REST API Reference"
---
<div class="container">
  <div class="row">
    <div class="col-md-3" id="sidenav">
      <nav class="docs-sidebar" data-spy="affix" data-offset-top="275">
        <ul class="nav nav-stacked fixed">
          <li>
            <a href="#applications">Applications</a>
            <ul class="nav nav-stacked">
              <li><a href="#list-applications">List Applications</a></li>
              <li><a href="#get-application-details">Get Application Details</a></li>
              <li><a href="#modify-application">Modify Application</a></li>
              <li><a href="#get-application-logo">Get Application Logo</a></li>
            </ul>
          </li>
          <li>
            <a href="#backups">Backups</a>
            <ul class="nav nav-stacked">
              <li><a href="#list-backups">List Backups</a></li>
              <li><a href="#get-backup-details">Get Backup Details</a></li>
              <li><a href="#create-backup">Create Backup</a></li>
              <li><a href="#restore-backup">Restore Backup</a></li>
              <li><a href="#delete-backup">Delete Backup</a></li>
            </ul>
          </li>
          <li>
            <a href="#certificates">Certificates</a>
            <ul class="nav nav-stacked">
              <li><a href="#list-certificates">List Certificates</a></li>
              <li><a href="#get-certificate-details">Get Certificate Details</a></li>
              <li><a href="#generate-certificate">Generate Certificate</a></li>
              <li><a href="#upload-certificate">Upload Certificate</a></li>
              <li><a href="#assign-certificate">Assign Certificate</a></li>
              <li><a href="#delete-certificate">Delete Certificate</a></li>
              <li><a href="#list-certificate-authorities">List Certificate Authorities</a></li>
              <li><a href="#get-certificate-authority-details">Get Certificate Authority Details</a></li>
              <li><a href="#download-certificate-authority">Download Certificate Authority</a></li>
              <li><a href="#delete-certificate-authority">Delete Certificate Authority</a></li>
            </ul>
          </li>
          <li>
            <a href="#configuration">Configuration</a>
            <ul class="nav nav-stacked">
              <li><a href="#get-arkos-configuration">Get arkOS Configuration</a></li>
              <li><a href="#update-arkos-configuration">Update arkOS Configuration</a></li>
              <li><a href="#patch-arkos-configuration">Patch arkOS Configuration</a></li>
              <li><a href="#get-arkos-system-time">Get arkOS System Time</a></li>
              <li><a href="#update-arkos-system-time">Update arkOS System Time</a></li>
              <li><a href="#shutdown-system">Shutdown System</a></li>
              <li><a href="#reboot-system">Reboot System</a></li>
            </ul>
          </li>
          <li>
            <a href="#databases">Databases</a>
            <ul class="nav nav-stacked">
              <li><a href="#get-databases">Get Databases</a></li>
              <li><a href="#get-database-details">Get Database Details</a></li>
              <li><a href="#create-database">Create Database</a></li>
              <li><a href="#execute-sql-on-database">Execute SQL on Database</a></li>
              <li><a href="#download-database">Download Database</a></li>
              <li><a href="#delete-database">Delete Database</a></li>
              <li><a href="#get-database-users">Get Database Users</a></li>
              <li><a href="#get-database-user-details">Get Database User Details</a></li>
              <li><a href="#create-database-user">Create Database User</a></li>
              <li><a href="#change-database-user-permissions">Change Database User Permissions</a></li>
              <li><a href="#delete-database-user">Delete Database User</a></li>
              <li><a href="#get-database-types">Get Database Types</a></li>
            </ul>
          </li>
          <li>
            <a href="#file-manager">File Manager</a>
            <ul class="nav nav-stacked">
              <li><a href="#list-files-and-folders">List Files and Folders</a></li>
              <li><a href="#get-file-details">Get File/Folder Details</a></li>
              <li><a href="#create-file">Create File or Folder</a></li>
              <li><a href="#upload-file">Upload File</a></li>
            </ul>
          </li>
        </ul>
        <a href="#top" class="back-to-top">Back to Top</a>
      </nav>
    </div>
    <div id="content" class="col-md-9">
      <div class="alert">
        <h3><i class="fa fa-warning pull-left"></i></h3>
        <p>This documentation is a work in progress.</p>
      </div>
      <h1 id="applications" class="page-header">Applications</h1>

      <div class="api-item">
        <h2 id="list-applications">List Applications</h2>
        <h3><span class="text-success">GET</span> /api/apps</h3>
        <p class="lead">Returns a list of all applications present on the system and their status, as well as applications available but not yet installed.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/apps
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>List of application detail objects.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
    "apps": [
        {
            "id": "wallabag",
            "name": "Wallabag",
            ...
        },
        {
            "id": "wordpress",
            "name": "Wordpress",
            ...
        }
    ]
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="get-application-details">Get Application Details</h2>
        <h3><span class="text-success">GET</span> /api/apps/:id</h3>
        <p class="lead">Returns details on the specified application.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/apps/wordpress
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>Application detail object.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "app": {
    "app_author": "Automattic",
    "app_homepage": "https://wordpress.org",
    "assets": {
      "logo": 31,
      "screens": [
        32,
        33,
        34,
        35
      ]
    },
    "author": "arkOS",
    "categories": [
      {
        "primary": "Websites",
        "secondary": [
          "Blogs",
          "Websites",
          "CMS"
        ]
      }
    ],
    "database_engines": [
      "db-mariadb"
    ],
    "dependencies": [
      {
        "binary": null,
        "name": "php",
        "package": "php",
        "type": "system"
      },
      {
        "binary": null,
        "name": "PHP xCache",
        "package": "php-xcache",
        "type": "system"
      },
      {
        "name": "MariaDB",
        "package": "db-mariadb",
        "type": "app"
      }
    ],
    "description": {
      "long": "WordPress started as just a blogging system, but has evolved to be used as full content management system and so much more through the thousands of plugins, widgets, and themes, WordPress is limited only by your imagination. (And tech chops.)",
      "short": "Open-source CMS and blogging platform"
    },
    "download_url": "https://wordpress.org/wordpress-4.1.1.tar.gz",
    "error": "",
    "generation": 1,
    "homepage": "https://arkos.io",
    "icon": "fa fa-wordpress",
    "id": "wordpress",
    "installed": true,
    "is_ready": true,
    "loadable": true,
    "logo": true,
    "modules": [
      "website",
      "backup"
    ],
    "name": "WordPress",
    "screenshots": [
      "screen-1.jpg",
      "screen-2.jpg",
      "screen-3.jpg",
      "screen-4.jpg"
    ],
    "services": [
      {
        "binary": "mysqld",
        "name": "MariaDB",
        "ports": []
      },
      {
        "binary": "php-fpm",
        "name": "PHP FastCGI",
        "ports": []
      }
    ],
    "type": "website",
    "upgradable": "",
    "uses_php": true,
    "uses_ssl": true,
    "version": "4.1.1-1",
    "website_updates": false
  }
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="modify-application">Modify Application</h2>
        <h3><span class="text-success">PUT</span> /api/apps/:id</h3>
        <p class="lead">Installs or removes an application.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Content-type: application/json' -H 'Authorization: Bearer <token>' -X PUT <url>/api/apps/wordpress --data '{"app": {"operation": "install"}}'
        {% endhighlight %}

        <h4>Request Requires</h4>
        <dl>
            <dt>operation</dt>
            <dd>The operation to perform: either <code>install</code> or <code>uninstall</code>.</dd>
        </dl>

        <h4>Responds With</h4>
        <p>Application detail object.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="get-application-logo">Get Application Logo</h2>
        <h3><span class="text-success">GET</span> /api/apps/logo/:id</h3>
        <p class="lead">Get the application logo provided with the application.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl <url>/api/apps/logo/wordpress
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>Raw application logo image (usually a PNG file).</p>
      </div>
      <hr />
      <br />

      <h1 id="backups" class="page-header">Backups</h1>

      <div class="api-item">
        <h2 id="list-backups">List Backups</h2>
        <h3><span class="text-success">GET</span> /api/backups</h3>
        <p class="lead">Returns a list of created backup archives available in the server's designated storage location.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/backups
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>List of backup detail objects.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
    "apps": [
        {
            "icon": "fa fa-globe",
            "id": "testghost/20150317124530",
            ...
        },
        {
            "icon": "fa fa-wordpress",
            "id": "testpress/20150317102919",
            ...
        },
    ]
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="get-backup-details">Get Backup Details</h2>
        <h3><span class="text-success">GET</span> /api/backups/:id</h3>
        <p class="lead">Returns details on the specified backup archive.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Backup ID, composed from the application ID, a slash, and the timestamp.</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/backups/testghost/20150317124530
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>Backup detail object.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "backup": [
    {
      "icon": "fa fa-globe",
      "id": "testghost/20150317124530",
      "is_ready": true,
      "path": "/var/lib/arkos/backups/testghost/testghost-20150317124530.tar.gz",
      "pid": "testghost",
      "site_type": "ghost",
      "size": 14612219,
      "time": "2015-03-17T12:45:30-04:00",
      "type": "site",
      "version": "0.5.10-1"
    }
  ]
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="create-backup">Create Backup</h2>
        <h3><span class="text-success">POST</span> /api/backups/:id</h3>
        <p class="lead">Adds a backup for the specified application ID type.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Application ID or existing website ID to create the backup for.</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' -X POST <url>/api/backups/wordpress
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>HTTP 201, with Location header specifying Job endpoint to track.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="restore-backup">Restore Backup</h2>
        <h3><span class="text-success">PUT</span> /api/backups/:id</h3>
        <p class="lead">Restores an existing backup.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Backup ID, composed from the application ID, a slash, and the timestamp.</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Content-type: application/json' -H 'Authorization: Bearer <token>' -X PUT <url>/api/backups/testghost/20150317124530 --data '{"backup": {...}}'
        {% endhighlight %}

        <h4>Request Requires</h4>
        <em>A backup detail object with at least the following parameters:</em>
        <dl>
            <dt>pid</dt>
            <dd>The application ID or existing website ID that the backup was created from.</dd>
            <dt>type</dt>
            <dd>Either `app` or `site`.</dd>
            <dt>site_type</dt>
            <dd>The application ID of the website type that the backup was created for. <em>(Only if type == "site").</em></dd>
            <dt>icon</dt>
            <dd>Icon font class of the website type that the backup was created for. <em>(Only if type == "site").</em></dd>
        </dl>

        <h4>Responds With</h4>
        <p>HTTP 201, with Location header specifying Job endpoint to track.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="delete-backup">Delete Backup</h2>
        <h3><span class="text-success">DELETE</span> /api/backups/:id</h3>
        <p class="lead">Deletes an existing backup from the storage location.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Backup ID, composed from the application ID, a slash, and the timestamp.</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' -X DELETE <url>/api/backups/testghost/20150317124530
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>HTTP 204.</p>
      </div>
      <hr />
      <br />

      <h1 id="certificates" class="page-header">Certificates</h1>

      <div class="api-item">
        <h2 id="list-certificates">List Certificates</h2>
        <h3><span class="text-success">GET</span> /api/certs</h3>
        <p class="lead">Returns a list of SSL/TLS certificates present on the system.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/certs
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>List of SSL/TLS certificate detail objects.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
    "certs": [
        {
            "assigns": [],
            "domain": "secure.testdomain.xyz",
            "expiry": "2017-02-03T22:32:22",
            ...
        },
        {
            "assigns": [],
            "domain": "*.mydomain.net",
            "expiry": "2017-02-03T22:32:22",
            ...
        }
    ]
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="get-certificate-details">Get Certificate Details</h2>
        <h3><span class="text-success">GET</span> /api/certs/:id</h3>
        <p class="lead">Returns details on the specified SSL/TLS certificate.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Certificate name/ID.</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/certs/testcert
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>Certificate detail object.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "cert": {
    "assigns": [],
    "domain": "secure.testdomain.xyz",
    "expiry": "2017-02-03T22:32:22",
    "id": "testcert",
    "is_ready": true,
    "keylength": 4096,
    "keytype": "RSA",
    "md5": "0E:EB:5D:D4:65:15:28:AC:02:31:94:BE:22:74:6C:D8",
    "sha1": "F6:B8:6E:1C:99:42:82:6E:2A:A8:B1:AB:58:8D:F2:E7:43:3E:29:C2"
  }
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="generate-certificate">Generate Certificate</h2>
        <h3><span class="text-success">POST</span> /api/certs</h3>
        <p class="lead">Instructs the server to generate a self-signed SSL/TLS certificate.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Content-type: application/json' -H 'Authorization: Bearer <token>' -X POST <url>/api/certs --data '{"cert": {...}}'
        {% endhighlight %}

        <h4>Request Requires</h4>
        <em>An object with at least the following parameters:</em>
        <dl>
            <dt>id</dt>
            <dd>The ID (name) for the new certificate.</dd>
            <dt>domain</dt>
            <dd>Domain ID that the certificate is to be valid for.</dd>
            <dt>country</dt>
            <dd>ISO-3166 (two-letter) country code abbreviation for certificate metadata.</dd>
            <dt>state</dt>
            <dd>State, province or region for certificate metadata.</dd>
            <dt>locale</dt>
            <dd>City, town or locale for certificate metadata.</dd>
            <dt>email</dt>
            <dd>Email address for certificate metadata.</dd>
            <dt>keytype</dt>
            <dd>Type of key to generate with the certificate. Can be `rsa` or `dsa`.</dd>
            <dt>keylength</dt>
            <dd>Bit-length of key to generate with the certificate.</dd>
        </dl>

        <h4>Responds With</h4>
        <p>HTTP 201, with Location header specifying Job endpoint to track.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="upload-certificate">Upload Certificate</h2>
        <h3><span class="text-success">POST</span> /api/certs</h3>
        <p class="lead">Adds an externally-sourced SSL/TLS certificate to the server via an upload from the client.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' -X POST <url>/api/certs --form 'id=certname;file[0]=@certfile.pem;file[1]=@keyfile.key'
        {% endhighlight %}

        <h4>Request Requires</h4>
        <em>A multipart form submission with the following items:</em>
        <dl>
            <dt>id</dt>
            <dd>The ID (name) for the new certificate.</dd>
            <dt>file[0]</dt>
            <dd>The certificate file in PEM format.</dd>
            <dt>file[1]</dt>
            <dd>The non-encrypted key file.</dd>
            <dt>file[2]</dt>
            <dd>The certificate chain file to append in PEM format. <em>Optional.</em></dd>
        </dl>

        <h4>Responds With</h4>
        <p>HTTP 201, with Location header specifying Job endpoint to track.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="assign-certificate">Assign Certificate</h2>
        <h3><span class="text-success">PUT</span> /api/certs/:id</h3>
        <p class="lead">Assign/unassign the specified certificate to/from a service or website.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Certificate name/ID.</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Content-type: application/json' -H 'Authorization: Bearer <token>' -X PUT <url>/api/certs --data '{"cert": {...}}'
        {% endhighlight %}

        <h4>Request Requires</h4>
        <em>A certificate detail object with at least the following items:</em>
        <dl>
            <dt>assigns</dt>
            <dd>A list of qualified assign objects. Assign objects present here that were not on the object prior will have SSL enabled on their corresponding service/website. Conversely, assigns missing from this list will have SSL disabled if the certificate was assigned to them prior.</dd>
        </dl>

        <h4>Responds With</h4>
        <p>Certificate detail object.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="delete-certificate">Delete Certificate</h2>
        <h3><span class="text-success">DELETE</span> /api/certs/:id</h3>
        <p class="lead">Deletes an existing SSL/TLS certificate from the server.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Certificate name/ID.</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' -X DELETE <url>/api/certs/testcert
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>HTTP 204.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="list-certificate-authorities">List Certificate Authorities</h2>
        <h3><span class="text-success">GET</span> /api/certauths</h3>
        <p class="lead">Returns a list of SSL/TLS certificate authorities generated by the server to handle self-signed certificates.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/certauths
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>List of SSL/TLS certificate authority detail objects.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "certauths": [
    {
      "expiry": "2020-02-02T22:58:03",
      "id": "testdomain.xyz"
    },
    {
      "expiry": "2020-02-02T22:58:03",
      "id": "mydomain.net"
    }
  ]
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="get-certificate-authority-details">Get Certificate Authority Details</h2>
        <h3><span class="text-success">GET</span> /api/certauths/:id</h3>
        <p class="lead">Returns details on the specified SSL/TLS certificate authority.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Certificate authority name/ID (i.e., the domain it is effective for).</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/certauths/testdomain.xyz
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>Certificate authority detail object.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "certauth": {
    "expiry": "2020-02-02T22:58:03",
    "id": "testdomain.xyz"
  }
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="download-certificate-authority">Download Certificate Authority</h2>
        <h3><span class="text-success">GET</span> /api/certauths/:id?download=true</h3>
        <p class="lead">Downloads the certificate authority X509 file.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl <url>/api/certauths/testdomain.xyz?download=true
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>Raw certificate file in PEM format.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="delete-certificate-authority">Delete Certificate Authority</h2>
        <h3><span class="text-success">DELETE</span> /api/certauths/:id</h3>
        <p class="lead">Deletes a SSL/TLS certificate authority from the server.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Certificate authority name/ID (i.e., the domain it is effective for).</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' -X DELETE <url>/api/certauths/testdomain.xyz
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>HTTP 204.</p>
      </div>
      <hr />
      <br />

      <h1 id="configuration" class="page-header">Configuration</h1>

      <div class="api-item">
        <h2 id="get-arkos-configuration">Get arkOS Configuration</h2>
        <h3><span class="text-success">GET</span> /api/config</h3>
        <p class="lead">Returns the arkOS configuration file, usually located at `/etc/arkos/settings.json`.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/config
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>arkOS configuration as JSON object, as well as system hostname and timezone settings.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "config": {
    "apps": {
      "app_dir": "/var/lib/arkos/applications",
      "purge": true
    },
    "backups": {
      "driver": "filesystem",
      "location": "/var/lib/arkos/backups"
    },
    ...
  },
  "hostname": "arkosdev",
  "timezone": {
    "region": "America",
    "zone": "Montreal"
  }
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="update-arkos-configuration">Update arkOS Configuration</h2>
        <h3><span class="text-success">PUT</span> /api/config</h3>
        <p class="lead">Replace entire arkOS configuration with a JSON object you provide.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Content-type: application/json' -H 'Authorization: Bearer <token>' -X PUT <url>/api/config --data '{"config": {...}}'
        {% endhighlight %}

        <h4>Request Requires</h4>
        <em>A JSON object in proper arkOS configuration format.</em>

        <h4>Responds With</h4>
        <p>arkOS configuration after the changes, as if called via GET.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="patch-arkos-configuration">Patch arkOS Configuration</h2>
        <h3><span class="text-success">PATCH</span> /api/config</h3>
        <p class="lead">Change individual values on the arkOS system configuration.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Content-type: application/json' -H 'Authorization: Bearer <token>' -X PATCH <url>/api/config --data '{"config": {...}}'
        {% endhighlight %}

        <h4>Request Requires</h4>
        <em>A JSON object with the sections, keys and values of the arkOS configuration that you want to change.</em>

        <h4>Responds With</h4>
        <p>arkOS configuration after the changes, as if called via GET.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="get-arkos-system-time">Get arkOS System Time</h2>
        <h3><span class="text-success">GET</span> /api/config/datetime</h3>
        <p class="lead">Get the current arkOS system time and NTP offset.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/config/datetime
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>arkOS system time in ISO-8601 format and NTP offset in seconds.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "datetime": {
    "datetime": "2015-05-30T12:07:26.270941-04:00",
    "offset": 0.2051558494567871
  }
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="update-arkos-system-time">Update arkOS System Time</h2>
        <h3><span class="text-success">PUT</span> /api/config/systemtime</h3>
        <p class="lead">Tell arkOS to update its system time via its default NTP server.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' -X PUT <url>/api/config/systemtime
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>System time and offset after the update, as if called via GET.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="shutdown-system">Shutdown System</h2>
        <h3><span class="text-success">POST</span> /api/config/shutdown</h3>
        <p class="lead">Tell arkOS to immediately shut down.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' -X POST <url>/api/config/shutdown
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="reboot-system">Reboot System</h2>
        <h3><span class="text-success">POST</span> /api/config/reboot</h3>
        <p class="lead">Tell arkOS to immediately reboot.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' -X POST <url>/api/config/reboot
        {% endhighlight %}
      </div>
      <hr />
      <br />

      <h1 id="databases" class="page-header">Databases</h1>

      <div class="api-item">
        <h2 id="get-databases">Get Databases</h2>
        <h3><span class="text-success">GET</span> /api/databases</h3>
        <p class="lead">Get all databases registered with arkOS on the system.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/databases
        {% endhighlight %}

        <h4>Optional URL Parameters</h4>
        <dl>
            <dt>rescan</dt>
            <dd>If true, force a server-side rescan of system databases.</dd>
        </dl>

        <h4>Responds With</h4>
        <p>List of database detail objects.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "databases": [
    {
      "id": "testdb",
      "is_ready": true,
      "size": 0,
      "type_id": "db-sqlite3",
      "type_name": "SQLite3"
    },
    ...
  ]
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="get-database-details">Get Database Details</h2>
        <h3><span class="text-success">GET</span> /api/databases/:id</h3>
        <p class="lead">Returns details on the specified database.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Database name/ID.</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/databases/testlite
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>Database detail object.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "database": {
    "id": "testdb",
    "is_ready": true,
    "size": 0,
    "type_id": "db-sqlite3",
    "type_name": "SQLite3"
  }
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="create-database">Create Database</h2>
        <h3><span class="text-success">POST</span> /api/databases</h3>
        <p class="lead">Add a new database to the system.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Content-type: application/json' -H 'Authorization: Bearer <token>' -X POST <url>/api/databases --data '{"database": {...}}'
        {% endhighlight %}

        <h4>Request Requires</h4>
        <em>An object with at least the following parameters:</em>
        <dl>
            <dt>id</dt>
            <dd>The ID (name) for the new database.</dd>
            <dt>type_id</dt>
            <dd>The ID of the database type (see database type methods below).</dd>
        </dl>

        <h4>Responds With</h4>
        <p>Database detail object.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="execute-sql-on-database">Execute SQL on Database</h2>
        <h3><span class="text-success">PUT</span> /api/databases/:id</h3>
        <p class="lead">Execute provided SQL code on a database of your choice.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Content-type: application/json' -H 'Authorization: Bearer <token>' -X PUT <url>/api/databases/testdb --data '{"database": {...}}'
        {% endhighlight %}

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Database user name/ID.</dd>
        </dl>

        <h4>Request Requires</h4>
        <em>An object with at least the following parameter:</em>
        <dl>
            <dt>execute</dt>
            <dd>A string of properly formatted SQL code to execute.</dd>
        </dl>

        <h4>Responds With</h4>
        <p>A JSON object with two keys: <code>id</code> with the ID of the database, and <code>result</code>, a string of the result text taken from the database engine.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="download-database">Download Database</h2>
        <h3><span class="text-success">GET</span> /api/databases/:id?download=true</h3>
        <p class="lead">Dumps the database to a SQL file and downloads.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl <url>/api/databases/testdb?download=true
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>Raw database file in SQL format.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="delete-database">Delete Database</h2>
        <h3><span class="text-success">DELETE</span> /api/databases/:id</h3>
        <p class="lead">Deletes a database from the server.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Database name/ID.</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' -X DELETE <url>/api/databases/testdb
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>HTTP 204.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="get-database-users">Get Database Users</h2>
        <h3><span class="text-success">GET</span> /api/database_users</h3>
        <p class="lead">Get all database users registered with arkOS on the system. Only applicable for database engines like MariaDB that feature user management.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/database_users
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>List of database user detail objects.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "database_users": [
    {
      "id": "testuser",
      "is_ready": true,
      "permissions": "GRANT USAGE ON *.* TO 'testuser'@'localhost'\n",
      "type_id": "db-mariadb",
      "type_name": "MariaDB"
    },
    ...
  ]
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="get-database-user-details">Get Database User Details</h2>
        <h3><span class="text-success">GET</span> /api/database_users/:id</h3>
        <p class="lead">Returns details on the specified database user.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Database user name/ID.</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/database_users/testuser
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>Database user detail object.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "database_user": {
    "id": "testuser",
    "is_ready": true,
    "permissions": "GRANT USAGE ON *.* TO 'testuser'@'localhost'\n",
    "type_id": "db-mariadb",
    "type_name": "MariaDB"
  }
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="create-database-user">Create Database User</h2>
        <h3><span class="text-success">POST</span> /api/database_users</h3>
        <p class="lead">Add a new database user to the system.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Content-type: application/json' -H 'Authorization: Bearer <token>' -X POST <url>/api/database_users --data '{"database_user": {...}}'
        {% endhighlight %}

        <h4>Request Requires</h4>
        <em>An object with at least the following parameters:</em>
        <dl>
            <dt>id</dt>
            <dd>The ID (name) for the new database user.</dd>
            <dt>type</dt>
            <dd>The ID of the database type (see database type methods below).</dd>
            <dt>passwd</dt>
            <dd>Password for the new database user.</dd>
        </dl>

        <h4>Responds With</h4>
        <p>Database user detail object.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="change-database-user-permissions">Change Database User Permissions</h2>
        <h3><span class="text-success">PUT</span> /api/database_users/:id</h3>
        <p class="lead">GRANT or REVOKE access for a database user to specific databases.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Content-type: application/json' -H 'Authorization: Bearer <token>' -X PUT <url>/api/database_users/testuser --data '{"database_user": {...}}'
        {% endhighlight %}

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Database user name/ID.</dd>
        </dl>

        <h4>Request Requires</h4>
        <em>An object with at least the following parameter:</em>
        <dl>
            <dt>operation</dt>
            <dd><code>check</code> to obtain a list of all GRANTs, <code>grant</code> to GRANT ALL to a database, or <code>revoke</code> to REVOKE ALL on a database.</dd>
            <dt>database</dt>
            <dd>The ID of the database to perform this operation with.</dd>
        </dl>

        <h4>Responds With</h4>
        <p>Database user detail object.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="delete-database-user">Delete Database User</h2>
        <h3><span class="text-success">DELETE</span> /api/database_users/:id</h3>
        <p class="lead">Deletes a database user from the server.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>id</dt>
            <dd>Database user name/ID.</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' -X DELETE <url>/api/database_users/testuser
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>HTTP 204.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="get-database-types">Get Database Types</h2>
        <h3><span class="text-success">GET</span> /api/database_types</h3>
        <p class="lead">Get all available database engines installed in arkOS, as well as their running status.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/database_types
        {% endhighlight %}

        <h4>Optional URL Parameters</h4>
        <dl>
            <dt>rescan</dt>
            <dd>If true, force a server-side rescan of database engines.</dd>
        </dl>

        <h4>Responds With</h4>
        <p>List of database type detail objects. <code>state</code> is True if the database engine is running or does not require an active process.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "database_types": [
    {
      "id": "db-sqlite3",
      "name": "SQLite3",
      "state": true,
      "supports_users": false
    },
    {
      "id": "db-mariadb",
      "name": "MariaDB",
      "state": true,
      "supports_users": true
    }
  ]
}
        {% endhighlight %}
      </div>
      <hr />
      <br />

      <h1 id="file-manager" class="page-header">File Manager</h1>

      <div class="api-item">
        <h2 id="list-files-and-folders">List Files and Folders</h2>
        <h3><span class="text-success">GET</span> /api/files/:path</h3>
        <p class="lead">Get all databases registered with arkOS on the system.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/files/Lw**
        {% endhighlight %}

        <h4>Parameters</h4>
        <dl>
            <dt>path</dt>
            <dd>Base64-encoded safe string of an absolute path on the filesystem to look inside.</dd>
        </dl>

        <h4>Responds With</h4>
        <p>List of file detail objects.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "files": [
    {
      "binary": false,
      "folder": true,
      "group": "root",
      "hidden": false,
      "icon": "fa-folder-o",
      "id": "L3Zhcg**",
      "mimetype": null,
      "name": "var",
      ...
    },
    {
      "binary": false,
      "folder": true,
      "group": "root",
      "hidden": false,
      "icon": "fa-folder-o",
      "id": "L3Nydg**",
      "mimetype": null,
      "name": "srv",
      ...
  ]
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="get-file-details">Get File/Folder Details</h2>
        <h3><span class="text-success">GET</span> /api/files/:path</h3>
        <p class="lead">Returns details on the specified system file or folder.</p>

        <h4>Parameters</h4>
        <dl>
            <dt>path</dt>
            <dd>Base64-encoded safe string of an absolute path on the filesystem.</dd>
        </dl>

        <h4>Optional URL Parameters</h4>
        <dl>
            <dt>content</dt>
            <dd>If true and the path points to a text file, the call also returns the contents of the file.</dd>
        </dl>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' <url>/api/files/L2xpYjY0
        {% endhighlight %}

        <h4>Responds With</h4>
        <p>File/folder detail object. If <code>content</code> is true, also returns a key named <code>content</code> containing text file contents.</p>

        <h4>Example Response</h4>
        {% highlight json %}
{
  "file": {
      "binary": false,
      "folder": true,
      "group": "root",
      "hidden": false,
      "icon": "fa-link",
      "id": "L2xpYjY0",
      "mimetype": null,
      "name": "lib64",
      "path": "/lib64",
      "perms": {
        "oct": "0777",
        "str": "rwxrwxrwx"
      },
      "realpath": "/usr/lib",
      "selected": false,
      "size": 7,
      "type": "link",
      "user": "root"
    }
}
        {% endhighlight %}
      </div>
      <hr />

      <div class="api-item">
        <h2 id="create-file">Create File or Folder</h2>
        <h3><span class="text-success">POST</span> /api/files/:path</h3>
        <p class="lead">Adds a new file or folder inside the specified path. Path must be a folder.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Content-type: application/json' -H 'Authorization: Bearer <token>' -X POST <url>/api/files/Lw** --data '{"file": {...}}'
        {% endhighlight %}

        <h4>Parameters</h4>
        <dl>
            <dt>path</dt>
            <dd>Base64-encoded safe string of an absolute path on the filesystem to create inside.</dd>
        </dl>

        <h4>Request Requires</h4>
        <em>An object with at least the following parameters:</em>
        <dl>
            <dt>folder</dt>
            <dd>True or False depending if you want the new item to be a folder or a regular file.</dd>
            <dt>name</dt>
            <dd>The name of the file or folder to create.</dd>
        </dl>

        <h4>Responds With</h4>
        <p>File/folder detail object.</p>
      </div>
      <hr />

      <div class="api-item">
        <h2 id="upload-file">Upload File</h2>
        <h3><span class="text-success">POST</span> /api/files/:path</h3>
        <p class="lead">Uploads file(s) of your choice to the specified path. Path must be a folder.</p>

        <h4>Example</h4>
        {% highlight bash %}
        curl -H 'Authorization: Bearer <token>' -X POST <url>/api/files/Lw** --form 'file[0]=@filename.txt;file[1]=@secondfile.zip;...'
        {% endhighlight %}

        <h4>Parameters</h4>
        <dl>
            <dt>path</dt>
            <dd>Base64-encoded safe string of an absolute path on the filesystem to create inside.</dd>
        </dl>

        <h4>Request Requires</h4>
        <em>A multipart form submission with the following items:</em>
        <dl>
            <dt>file[0]</dt>
            <dd>The first file to upload.</dd>
            <dt>file[1]</dt>
            <dd>Optional subsequent files to upload, with the array index increased each time.</dd>
        </dl>

        <h4>Responds With</h4>
        <p>File/folder detail object.</p>
      </div>
      <hr />

    </div>
  </div>
</div>

<script>
    $('body').scrollspy({
        target: '.docs-sidebar',
        offset: 40
    });
</script>
